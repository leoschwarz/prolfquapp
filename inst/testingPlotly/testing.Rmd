---
title: "Untitled"
output: html_document
date: '2022-03-10'
editor_options: 
  chunk_output_type: console
---

```{r setup, echo = FALSE}

REPORTDATA <- readRDS("../application/SAINTexpressFragPipe/REPORTDATA.rds")
datax <- REPORTDATA$cse$get_contrasts()


prot_annot <- rename(REPORTDATA$prot_annot, Prey=protein)
prot_annot <- inner_join(prot_annot, datax,
                         multiple = "all")
bb <- prot_annot %>% select(Prey, description, Bait, BFDR )
bb <- bb |> pivot_wider(names_from = "Bait", names_prefix = "BFDR.", values_from = BFDR)
bb <- SharedData$new(bb, ~Prey, group = "Choose protein")
prot_annot <- SharedData$new(prot_annot, ~Prey, group = "Choose protein")
DT::datatable(bb, filter="bottom")

```


```{r echo = FALSE}
res <- list()

xd <- prolfqua::volcano_plotly( datax , effect = "log2_EFCs", significance = "BFDR", contrast = "Bait", xintercept = c(3), yintercept = 0.1)
subplot(xd, shareX = TRUE, shareY = TRUE)

```



